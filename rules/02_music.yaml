

# ===============================================
#  CATEGORY: music (M#)
# ===============================================

category: "M#"
name: "MuzicÄƒ & Moderator"
version: "1.0"
description: >
  Reguli pentru recomandarea furnizorilor muzicali: DJ, Solist, MiniBand, Band, OrchestrÄƒ, MixModern, cu opÈ›iunea Moderator (MC).
  Include clasificare, constrÃ¢ngeri pe salÄƒ, scorare, sinergii È™i È™abloane UI.

inputs:
  required:
    - guests_count
  optional:
    - budget_music        # number or {low|medium|high}
    - wedding_style       # {modern|elegant|rustic|tradiÈ›ional|club|mixt}
    - venue:
      has_stage: boolean            # maps -> venue.fields.has_stage
      min_stage_area_m2: number     # (input liber; nu e Ã®n taxonomy, Ã®l foloseÈ™ti doar Ã®n rules)
      has_sound_limit: boolean      # maps -> venue.fields.has_sound_limit
      # is_outdoor -> foloseÈ™te context.event_location
      price_per_person_eur: number  # maps -> venue.pricing.price_per_person_eur
    - context:
      event_location: string        # "indoor" | "outdoor"

    - languages_needed    # {RO|RU|RO+RU}
    - music_preferences   # list: [populara, international, retro, etno, live_only, club]
    - package_preference  # {DJ|Solist|MiniBand|Band|Orchestra|MixModern|Nehotarat}
    - timeline:
        start: "HH:MM"
        end: "HH:MM"
        afterparty: boolean
    - age_mix             # {tineri|mix|traditional}
    - wants_moderator     # {yes|no|auto}

packages:
  # tipologii + atribute de bazÄƒ (range-uri orientative, pot fi override per vendor)
  - code: DJ
    title: "DJ"
    team_size: 1
    mc_options: ["none", "team_mc_optional", "separate"]
    price_range_eur: [600, 900]
    ideal_guests: [60, 150]
    energy: "high"
    includes: ["audio_system", "basic_lights"]
    tags: ["modern","urban","dance"]
  - code: DJ_MC
    extends: DJ
    title: "DJ + MC"
    team_size: 2
    price_range_eur: [1000, 1300]
  - code: SOLIST
    title: "Solist"
    team_size: 1
    instrument_options: ["none","clapa"]
    price_range_eur: [900, 1200]
    ideal_guests: [80, 160]
    energy: "medium-high"
    mc_options: ["team_mc_optional","separate","none"]
    dj_option: true
    tags: ["live","elegant","romantic"]
  - code: SOLIST_DJ_MC
    title: "Solist + DJ + MC"
    team_size: 3
    price_range_eur: [1500, 2100]
  - code: MINIBAND
    title: "Solist cu echipÄƒ (MiniBand)"
    team_size: 3
    team_range: [2, 4]
    instruments: ["clapa","chitara","saxofon","tobe"]
    price_range_eur: [1300, 1800]
    ideal_guests: [100, 200]
    energy: "high"
    mc_options: ["team_mc_optional","separate","none"]
    dj_option: true
    tags: ["live","band_mic","modern"]
  - code: BAND
    title: "Band complet"
    team_size: 6
    team_range: [5, 7]
    instruments: ["clapa","chitara","bas","saxofon","tobe","voce_f","voce_m"]
    price_range_eur: [2000, 3500]
    ideal_guests: [120, 300]
    energy: "very_high"
    mc_options: ["team_mc_optional","separate"]
    dj_option: true
    tags: ["live","concert","premium"]
  - code: ORCHESTRA
    title: "OrchestrÄƒ tradiÈ›ionalÄƒ"
    team_size: 8
    team_range: [6, 10]
    styles: ["traditionala_autentica","mixta","etno_moderna"]
    price_range_eur: [2500, 4000]
    ideal_guests: [150, 400]
    energy: "very_high"
    mc_options: ["team_mc_required"]
    dj_option: "afterparty_optional"
    tags: ["folclor","etno","tradiÈ›ional"]
  - code: MIXMODERN
    title: "Mix modern (DJ + instrumentist)"
    team_size: 2
    instruments: ["saxofon","vioara","trompeta","percutii"]
    price_range_eur: [1200, 1800]
    ideal_guests: [70, 150]
    energy: "high"
    mc_options: ["separate","none"]
    tags: ["modern","live_mix","trend"]

decision_tree:
  # selecteazÄƒ pachetul *de start* dacÄƒ mirii sunt nehotÄƒrÃ¢È›i (se re-scoreazÄƒ apoi pe vendorii concreÈ›i)
  steps:
    - if: "package_preference == 'DJ' or package_preference == 'Nehotarat'"
      choose:
        - when: "guests_count < 80"
          package: "DJ_MC"
        - else:
          package: "DJ"
    - if: "package_preference == 'Solist'"
      choose:
        - when: "guests_count <= 160"
          package: "SOLIST_DJ_MC"
        - else:
          package: "SOLIST"
    - if: "package_preference == 'MiniBand'"
      choose:
        - when: "guests_count in [100,200]"
          package: "MINIBAND"
    - if: "package_preference == 'Band'"
      choose:
        - when: "guests_count >= 120"
          package: "BAND"
    - if: "package_preference == 'Orchestra'"
      choose:
        - when: "guests_count >= 150"
          package: "ORCHESTRA"
    - if: "package_preference == 'MixModern'"
      choose:
        - package: "MIXMODERN"
    - if: "package_preference == 'Nehotarat'"
      choose:
        - when: "wedding_style in ['tradiÈ›ional'] or age_mix == 'traditional'"
          package: "ORCHESTRA"
        - when: "wedding_style in ['modern','elegant','club'] and guests_count between 80 and 160"
          package: "DJ_MC"
        - when: "guests_count between 100 and 200"
          package: "MINIBAND"
        - else:
          package: "MIXMODERN"

constraints:
  hard_blocks:
    - rule: "venue.fields.has_sound_limit == true"
      exclude_packages: ["BAND","ORCHESTRA","MINIBAND"]
      reason: "RestricÈ›ii de zgomot ale sÄƒlii."
    - rule: "context.event_location == 'outdoor' and music.fields.sound_power_kw >= 2"
      exclude_all: true
      reason: "Echipamente voluminoase/puternice fÄƒrÄƒ protecÈ›ie dedicatÄƒ pentru outdoor."
  soft_penalties:
    - rule: "venue.fields.has_stage == false"
      downgrade: ["BAND","ORCHESTRA","MINIBAND"]
      reason: "Nu existÄƒ scenÄƒ; preferÄƒ echipe compacte."
    - rule: "budget_music < 700"
      downgrade: ["BAND","ORCHESTRA","MINIBAND"]
      suggest: ["DJ","SOLIST"]
    - rule: "languages_needed == 'RO+RU'"
      require_vendor_field: "mc_languages includes 'RO+RU'"

scoring:
  total: 100
  weights:
    quality_experience: 25        # reviews, ani, portofoliu, echipamente
    mc_score: 15                  # vezi mc_scoring
    budget_fit: 20               # penalizare la depÄƒÈ™ire >10%
    venue_compat: 15             # scenÄƒ, zgomot, outdoor
    tech_gear: 10                # sunet, lumini, microfoane, fum
    synergies: 5                 # colaborÄƒri È™i compatibilitÄƒÈ›i
    style_match: 10              # potrivire cu preferinÈ›ele mirilor
  mc_scoring:
    weights:
      hall_recommendations: 30   # 1 reco=10p, 3+=30p
      years_experience: 20       # 1p/an, max 20
      lead_time_months: 20       # 12m=20, 9m=15, 6m=10, <3m=5
      punctual_organization: 10  # feedback salÄƒ
      languages: 10              # RO=5, RO+RU=10
      own_team: 5                # are DJ/sunetist stabil
      clear_pricing: 5           # ofertÄƒ clarÄƒ
  formulas:
    budget_fit: "max(0, 1 - max(0, (price_est - budget_music)/budget_music)) * 100"
    venue_compat: >
      case venue.fields.has_sound_limit: 
       if music.fields.sound_power_kw >= 2 then 0 else 100;
      + stage_bonus if venue.fields.has_stage and (package in ['MINIBAND','BAND','ORCHESTRA']);
      clipped 0..100
    final_score: >
      sum_component_weights_normalized

synergies:
  - with: "S#"
    rules:
      - if: "venue.fields.has_sound_limit"
        action: "downgrade BAND, ORCHESTRA, MINIBAND"
      - if: "venue.fields.has_stage and package in ['MINIBAND','BAND','ORCHESTRA']"
        action: "small bonus"
  - with: "FX#"
    rules:
      - if: "package in ['DJ','DJ_MC','MINIBAND','BAND','ORCHESTRA','MIXMODERN']"
        suggest: ["heavy_fog_if_allowed","dancefloor_lights"]
      - if: "venue.fields.allows_heavy_smoke == false"
        block: ["heavy_fog"]
  - with: "D#"
    rules:
      - if: "stage_decor_dense and package in ['MINIBAND','BAND','ORCHESTRA']"
        action: "warn for space & setup timing"
  - with: "F#/V#"
    rules:
      - if: "strong_stage_lights"
        action: "suggest photo_friendly preset at moments"

budget:
  compute:
    - meal_cost: "team_size * venue.pricing.price_per_person_eur"
    - base: "vendor.packages.price_eur"
    - extras: "mc_extra + dj_extra + instrumentist_extra + overtime + transport"
    - fx_addons: "optional"
    - total: "base + extras + meal_cost + fx_addons"
  expose_fields: ["music_fee","extras","meal_cost","total"]

ui:
  cards:
    - key: "DJ_MC"
      title: "DJ + Moderator"
      ideal: "60â€“150 invitaÈ›i, modern/elegant"
      note: "energie de club, dans continuu"
    - key: "SOLIST_DJ_MC"
      title: "Solist + DJ + MC"
      ideal: "80â€“160 invitaÈ›i"
      note: "emoÈ›ie live + continuitate"
    - key: "BAND"
      title: "Band complet + MC"
      ideal: "120â€“300 invitaÈ›i"
      note: "vibe de concert; 6â€“8 locuri la masÄƒ"
    - key: "ORCHESTRA"
      title: "OrchestrÄƒ + MC"
      ideal: "150â€“400 invitaÈ›i"
      note: "tradiÈ›ional autentic, energie mare"
    - key: "MIXMODERN"
      title: "DJ + sax/violin"
      ideal: "70â€“150 invitaÈ›i / afterparty"
      note: "trend 2025, elegant & energic"

  messages:
    intro: >
      Hai sÄƒ vorbim puÈ›in despre muzicÄƒ ðŸŽ¶ Atmosfera e jumÄƒtate din frumuseÈ›ea unei nunÈ›i â€”
      depinde de cine pune muzica, cum se comunicÄƒ cu invitaÈ›ii È™i cum se È›ine ritmul serii.
      ÃŽÈ›i arÄƒt pe scurt variantele È™i te ghidez pÃ¢nÄƒ alegem Ã®mpreunÄƒ formatul perfect.

    education_summary: >
      OpÈ›iunile principale sunt: DJ + MC (energie modernÄƒ), Solist + DJ (emoÈ›ie live + flux),
      MiniBand / Band (spectacol live), OrchestrÄƒ (tradiÈ›ional & etno), Mix modern (DJ + sax/violin).
      ÃŽn toate cazurile, MC-ul e recomandat (uneori inclus/obligatoriu).

    budget_explain_template: >
      La formaÈ›ii mai mari trebuie sÄƒ È›ii cont È™i de mesele pentru echipÄƒ.
      DacÄƒ meniul la salÄƒ este {{menu_price}} lei, iar echipa are {{team_size}} persoane,
      adaugi aproximativ {{meal_cost_lei}} lei ({{team_size}} Ã— {{menu_price}}) Ã®n bugetul total.
      Ex.: pentru un band de 7, la 1000 lei/meniu, e Ã®ncÄƒ 7000 lei.

    show_examples_prompt: >
      ÃŽÈ›i arÄƒt cinci exemple ca sÄƒ vezi diferenÈ›ele de energie È™i stil (video scurte):
      1) DJ + MC, 2) Solist + DJ + MC, 3) Band + MC, 4) OrchestrÄƒ + MC, 5) Mix modern.
      DupÄƒ ce le vezi, spune-mi ce vibe te atrage: modern & club, live cu momente,
      tradiÈ›ional sau un mix elegant?

    refine_questions: >
      CÃ¢È›i invitaÈ›i estimaÈ›i? (acum: {{guests_count}})
      Ce stil vÄƒ reprezintÄƒ mai mult (modern / tradiÈ›ional / mixt)? (acum: {{style}})
      AveÈ›i salÄƒ aleasÄƒ? Are restricÈ›ii de zgomot sau scenÄƒ? ({{venue_name}})
      PreferiÈ›i MC inclus Ã®n echipÄƒ sau separat (mai personalizat)? ({{mc_label}})

    reco_gbb_template: >
      Pe baza a ce mi-aÈ›i spus, aÈ™ porni cu:
      â€¢ Good â€” {{good_title}} (~{{good_total_eur}} â‚¬) + mese echipÄƒ ~{{good_meals_lei}} lei
      â€¢ Better â€” {{better_title}} (~{{better_total_eur}} â‚¬) + mese echipÄƒ ~{{better_meals_lei}} lei
      â€¢ Best â€” {{best_title}} (~{{best_total_eur}} â‚¬) + mese echipÄƒ ~{{best_meals_lei}} lei
      VreÈ›i sÄƒ deschidem detaliile pentru una dintre opÈ›iuni?

    noise_restriction_notice: >
      Sala are restricÈ›ii de zgomot, aÈ™a cÄƒ Band/OrchestrÄƒ nu sunt ideale aici.
      ÃŽÈ›i propun DJ + MC sau Solist + DJ â€” pÄƒstrÄƒm energia ridicatÄƒ È™i controlul volumului,
      fÄƒrÄƒ riscul de a Ã®ncÄƒlca regulile locaÈ›iei.

    small_stage_notice: >
      SpaÈ›iul pentru scenÄƒ e mai compact. Ca sÄƒ nu aglomerÄƒm locul,
      recomand DJ + MC sau Solist + DJ; dacÄƒ vrei sunet live mai bogat,
      un MiniBand mic (2â€“3 membri) rÄƒmÃ¢ne Ã®n grafic, fÄƒrÄƒ set-up voluminos.

    fx_upsell_tip: >
      DacÄƒ alegem DJ/Band, meritÄƒ pachet de lumini È™i fum greu pentru dansul mirilor (dacÄƒ sala permite).
      Pot seta È™i un preset â€žphoto-friendlyâ€ Ã®n momentele cheie, ca sÄƒ iasÄƒ fotografiile impecabile.

    confirm_selection_template: >
      Perfect, mergem pe {{package}}.
      Rezumat: prestatori â‰ˆ {{price_eur}} â‚¬, mese echipÄƒ â‰ˆ {{meal_cost_lei}} lei
      ({{team_size}} Ã— {{menu_price}}). Vrei sÄƒ-È›i trimit È™i 2 alternative apropiate ca preÈ›,
      ca sÄƒ comparÄƒm side-by-side?

    empathetic_close: >
      Nu existÄƒ alegere greÈ™itÄƒ â€” important e sÄƒ vÄƒ reprezinte stilul.
      Eu rÄƒmÃ¢n aici, ajustÄƒm pachetul cÃ¢nd vrei (MC separat, instrumentist, afterparty),
      È™i verific pentru voi disponibilitatea furnizorilor preferaÈ›i.

helpers:
  formatters:
    # CalculeazÄƒ automat costul meselor pentru echipÄƒ
    meal_cost_lei:
      args: ["team_size", "menu_price"]
      expr: "team_size * menu_price"   # evaluatÄƒ de motorul tÄƒu de reguli

    # Pachete Goodâ€“Betterâ€“Best: genereazÄƒ sumar cu totaluri È™i mese
    gbb_summary:
      args:
        - "good.team_size"
        - "good.menu_price"
        - "good.total_eur"
        - "better.team_size"
        - "better.menu_price"
        - "better.total_eur"
        - "best.team_size"
        - "best.menu_price"
        - "best.total_eur"
      returns:
        good_meals_lei: "good.team_size * good.menu_price"
        better_meals_lei: "better.team_size * better.menu_price"
        best_meals_lei: "best.team_size * best.menu_price"
        good_total_eur: "good.total_eur"
        better_total_eur: "better.total_eur"
        best_total_eur: "best.total_eur"
